<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Debug Employee Data</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 20px;
        }

        pre {
            background-color: #f5f5f5;
            padding: 10px;
            border-radius: 5px;
            overflow-x: auto;
        }

        button {
            padding: 10px;
            margin: 10px 0;
            cursor: pointer;
        }
    </style>
</head>

<body>
    <h1>Debug Employee Data</h1>

    <h2>LocalStorage Data</h2>
    <pre id="localStorage-data"></pre>

    <button id="fetch-api-data">Fetch API Employee Data</button>
    <h2>API Employee Data</h2>
    <pre id="api-data">Click the button above to fetch data</pre>

    <script>
        // Base URL for API calls
        const BASE_URL = "https://localhost:5001";

        // Display localStorage data
        function displayLocalStorage() {
            const container = document.getElementById('localStorage-data');
            const data = {};

            // Get all localStorage items
            for (let i = 0; i < localStorage.length; i++) {
                const key = localStorage.key(i);
                let value = localStorage.getItem(key);

                // Try to parse JSON values
                try {
                    value = JSON.parse(value);
                } catch (e) {
                    // Keep as string if not valid JSON
                }

                data[key] = value;
            }

            container.textContent = JSON.stringify(data, null, 2);
        }

        // Fetch employee data from API
        async function fetchEmployeeData() {
            const container = document.getElementById('api-data');
            container.textContent = 'Loading...';

            try {
                const accessToken = localStorage.getItem('accessToken');
                if (!accessToken) {
                    container.textContent = 'No access token found. Please log in first.';
                    return;
                }

                const response = await fetch(`${BASE_URL}/api/authentication/debug/employee-data`, {
                    method: 'GET',
                    headers: {
                        'Authorization': `Bearer ${accessToken}`,
                        'Accept': 'application/json'
                    }
                });

                const data = await response.json();
                container.textContent = JSON.stringify(data, null, 2);
            } catch (error) {
                container.textContent = `Error: ${error.message}`;
            }
        }

        // Initialize
        document.addEventListener('DOMContentLoaded', () => {
            displayLocalStorage();
            document.getElementById('fetch-api-data').addEventListener('click', fetchEmployeeData);
        });
    </script>
</body>

</html>